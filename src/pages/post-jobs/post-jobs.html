<ion-header>
  <ion-navbar color="dark">
    <ion-title>Post Job</ion-title>
    <ion-buttons end>
      <button ion-button (click)="dismiss()">
        Cancel
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-list>
    <form novalidate #postJobForm="ngForm">
      <ion-grid class="personal-details">
        <ion-row class="details_row">

          <ion-col col-12> 
            <ion-item> 
              <ion-label floating>Job name</ion-label>
              <ion-input type="text" name="title" [(ngModel)]="data.title" #title="ngModel" required minlength="3"></ion-input>
            </ion-item>
            <div class="form-validation">
              <div *ngIf="title?.errors && (title.dirty || title.touched)">
                <p *ngIf="title?.errors.required">Title is required</p>
                <p *ngIf="title?.errors.minlength">Title must be at least 3 charactors</p>
              </div>
            </div>
          </ion-col>

          <ion-col col-12>
            <ion-item>
              <ion-label floating>Category</ion-label>
              <ion-select name="category"  #category="ngModel" required (ionChange)="selectedCategory(data.category)" [(ngModel)]="data.category" multiple="false">
                <ion-option *ngFor="let category of categories; let i = index">{{category.name}}</ion-option>
              </ion-select>
            </ion-item> 
            <div class="form-validation">
              <div *ngIf="category?.errors && (category.dirty || category.touched)">
                <p *ngIf="category?.errors.required">Category is required</p>
              </div>
            </div>
          </ion-col>

          <ion-col col-12 *ngIf="data.category">
            <ion-item>
              <ion-label floating>Skills</ion-label>
              <ion-select name="skills"  #skills="ngModel" required [(ngModel)]="data.skills" multiple="true">
                <ion-option *ngFor="let skill of s.skills">{{skill}}</ion-option>
              </ion-select>
            </ion-item>
            <div class="form-validation">
              <div *ngIf="skills?.errors && (skills.dirty || skills.touched)">
                <p *ngIf="skills?.errors.required">Skills are required</p>
              </div>
            </div>
          </ion-col>

        </ion-row>

        <ion-row>
          <ion-col col-6>
            <ion-item>
              <ion-label floating>Job Type</ion-label>
              <ion-select name="jobType"  #jobType="ngModel" required [(ngModel)]="data.type" multiple="false">
                <ion-option>Full time</ion-option>
                <ion-option>Part time</ion-option>
                <ion-option>Once off</ion-option>
              </ion-select>
            </ion-item>
            <div class="form-validation">
              <div *ngIf="jobType?.errors && (jobType.dirty || jobType.touched)">
                <p *ngIf="jobType?.errors.required">Job type is required</p>
              </div>
            </div>
          </ion-col>
          <ion-col col-6>
            <ion-item>
              <ion-label floating>Experience</ion-label>
              <ion-select name="experience"  #experience="ngModel" required [(ngModel)]="data.experience" multiple="false">
                <ion-option>0-1 Year</ion-option>
                <ion-option>1-2 Years</ion-option>
                <ion-option>2-5 Years</ion-option>
                <ion-option>5+ Years</ion-option> 
              </ion-select>
            </ion-item>
            <div class="form-validation">
              <div *ngIf="experience?.errors && (experience.dirty || experience.touched)">
                <p *ngIf="experience?.errors.required">Experience is required</p>
              </div>
            </div>
          </ion-col>
        </ion-row> 
        <ion-row>
          <ion-col col-6 class="salary">
            <ion-item>
              <ion-label floating>Salary (R)</ion-label>
              <ion-input name="salary"  #salary="ngModel" required [(ngModel)]="data.salary" type="number"></ion-input>
            </ion-item>
            <div class="form-validation">
              <div *ngIf="salary?.errors && (salary.dirty || salary.touched)">
                <p *ngIf="salary?.errors.required">Salary is required</p>
              </div>
            </div>
          </ion-col>
          <ion-col class="frequency" col-6>
            <ion-item>
              <ion-label floating>Frequency</ion-label>
              <ion-select name="freq"  #freq="ngModel" required [(ngModel)]="data.frequency" multiple="false">
                <ion-option>Per day</ion-option>
                <ion-option>Per week</ion-option>
                <ion-option>Per month</ion-option>
                <ion-option>Once off</ion-option>
              </ion-select>
            </ion-item>
            <div class="form-validation">
              <div *ngIf="freq?.errors && (freq.dirty || freq.touched)">
                <p *ngIf="freq?.errors.required">Frequency is required</p>
              </div>
            </div>
          </ion-col>
        </ion-row> 
        <ion-row>
          <ion-col class="address" col-12>
            <ion-list>
              <ion-item tappable >
                <ion-label floating>Pick Job Address</ion-label>
                <ion-input name="address"  #address="ngModel" (ionFocus)="showAddressModal()" required [(ngModel)]="data.address" type="text"></ion-input>
              </ion-item>
              <div class="form-validation">
                <div *ngIf="address?.errors && (address.dirty || address.touched)">
                  <p *ngIf="address?.errors.required">Address is required</p>
                </div>
              </div>
            </ion-list> 
          </ion-col>
          <ion-col col-12>
            <ion-item>
              <ion-label floating>Job Description</ion-label>
              <ion-textarea name="description"  #description="ngModel" required [(ngModel)]="data.description" minlength="10" autocorrect="on" autocomplete="on" rows="3"></ion-textarea>
            </ion-item>
            <div class="form-validation">
              <div *ngIf="description?.errors && (description.dirty || description.touched)">
                <p *ngIf="description?.errors.required">Description is required</p>
                <p *ngIf="description?.errors.minlength">Description is too short</p>
              </div>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>
    </form>
    <div class="but form-validation">
      <p *ngIf="postJobForm.invalid">All fields are required</p>
      <button ion-button block color="dark" [disabled]="postJobForm.invalid" (click)="postJob()"> Post Job </button>
    </div>
  </ion-list>
    
</ion-content>